{
  "$schema": "https://raw.githubusercontent.com/Liinkiing/create-larastack-app/master/schemas/rules.schema.json",
  "version": 1,
  "rules": [
    {
      "id": "backend-without-mobile-overrides",
      "when": {
        "allOf": [{ "appSelected": "backend" }, { "appNotSelected": "mobile" }]
      },
      "operations": [
        {
          "type": "remove",
          "paths": [
            "backend/database/migrations/*personal_access_tokens*",
            "backend/app/Http/Controllers/Auth/MobileAppleAuthController.php",
            "backend/app/Http/Controllers/Auth/MobileGoogleAuthController.php",
            "backend/app/Http/Controllers/Auth/MobileTokenController.php",
            "backend/app/Http/Requests/Auth/MobileAppleLoginRequest.php",
            "backend/app/Http/Requests/Auth/MobileGoogleLoginRequest.php",
            "backend/app/Services/Auth/AppleIdTokenVerifier.php",
            "backend/app/Services/Auth/GoogleIdTokenVerifier.php"
          ]
        },
        {
          "type": "transform",
          "path": "backend/app/Models/User.php",
          "transform": "php.user.applyProfile",
          "options": {
            "profile": "no-mobile"
          }
        },
        {
          "type": "transform",
          "path": "backend/routes/api.php",
          "transform": "php.routes.api.applyProfile",
          "options": {
            "profile": "no-mobile"
          }
        },
        {
          "type": "transform",
          "path": "backend/database/migrations/0001_01_01_000000_create_users_table.php",
          "transform": "php.migration.users.applyProfile",
          "options": {
            "profile": "no-mobile"
          }
        },
        {
          "type": "transform",
          "path": "backend/config/services.php",
          "transform": "php.config.services.applyProfile",
          "options": {
            "profile": "no-mobile"
          }
        },
        {
          "type": "transform",
          "path": "backend/.env.example",
          "transform": "env.backend.applyProfile",
          "options": {
            "profile": "no-mobile"
          }
        }
      ]
    },
    {
      "id": "backend-without-frontend-overrides",
      "when": {
        "allOf": [{ "appSelected": "backend" }, { "appNotSelected": "frontend" }]
      },
      "operations": [
        {
          "type": "remove",
          "paths": [
            "backend/app/Http/Controllers/Auth/OAuthController.php",
            "backend/app/Http/Controllers/Auth/AuthenticatedSessionController.php",
            "backend/app/Http/Requests/Auth/LoginRequest.php"
          ]
        },
        {
          "type": "transform",
          "path": "backend/routes/web.php",
          "transform": "php.routes.web.applyProfile",
          "options": {
            "profile": "no-frontend"
          }
        }
      ]
    },
    {
      "id": "backend-only-overrides",
      "when": {
        "allOf": [{ "appSelected": "backend" }, { "appNotSelected": "mobile" }, { "appNotSelected": "frontend" }]
      },
      "operations": [
        {
          "type": "transform",
          "path": "backend/routes/api.php",
          "transform": "php.routes.api.applyProfile",
          "options": {
            "profile": "backend-only"
          }
        },
        {
          "type": "transform",
          "path": "backend/app/Models/User.php",
          "transform": "php.user.applyProfile",
          "options": {
            "profile": "backend-only"
          }
        },
        {
          "type": "transform",
          "path": "backend/database/migrations/0001_01_01_000000_create_users_table.php",
          "transform": "php.migration.users.applyProfile",
          "options": {
            "profile": "backend-only"
          }
        },
        {
          "type": "transform",
          "path": "backend/config/services.php",
          "transform": "php.config.services.applyProfile",
          "options": {
            "profile": "backend-only"
          }
        },
        {
          "type": "transform",
          "path": "backend/.env.example",
          "transform": "env.backend.applyProfile",
          "options": {
            "profile": "backend-only"
          }
        }
      ]
    },
    {
      "id": "sync-graphql-config",
      "operations": [
        {
          "type": "transform",
          "path": "graphql.config.yml",
          "transform": "yaml.graphql.syncProjects"
        }
      ]
    },
    {
      "id": "sync-opencode-config",
      "operations": [
        {
          "type": "transform",
          "path": "opencode.json",
          "transform": "json.opencode.syncMcp"
        }
      ]
    }
  ]
}
